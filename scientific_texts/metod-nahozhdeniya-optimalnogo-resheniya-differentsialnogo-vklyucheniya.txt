*27*
УДК 517.977.5       Вестник СПбГУ. Математика. Механика. Астрономия. 2018. Т. 5 (63). Вып. 4
MSC 49J21

Метод нахождения оптимального решения
дифференциального включения?
А. В. Фоминых
Санкт-Петербургский государственный университет,
Российская Федерация, 199034, Санкт-Петербург, Университетская наб., 7–9

     В статье исследуется дифференциальное включение с заданным непрерывным выпуклым многозначным отображением. На заданном конечном промежутке времени
     требуется построить решение дифференциального включения, которое удовлетворяет
     заданным начальному и конечному условиям и доставляет минимум интегральному
     функционалу. С помощью аппарата опорных функций исходная задача сводится к минимизации некоторого функционала в пространстве кусочно-непрерывных функций.
     В случае непрерывности производной опорной функции многозначного отображения
     по фазовым переменным этот функционал дифференцируем по Гато. В статье найден
     градиент Гато, получены необходимые условия минимума данного функционала. На
     основании этих условий к исходной задаче применяется метод наискорейшего спуска.
     Численные примеры иллюстрируют работу построенного алгоритма.
     Ключевые слова: дифференциальное включение, опорная функция, метод наискорейшего спуска.


    1. Введение. Как известно, дифференциальное включение [1, 2] является обобщением обыкновенных дифференциальных уравнений, поскольку, например, неявные дифференциальные уравнения, дифференциальные неравенства и дифференциальные уравнения с ограничениями на фазовые координаты, могут быть записаны
в виде дифференциальных включений. Кроме того, известно, что многие задачи
оптимального управления при естественных предположениях могут быть сведены
к дифференциальным включениям [3]. Как правило, дифференциальное включение имеет бесконечное множество решений, поэтому естественно поставить задачу
выделения решения, оптимального в каком-то смысле, например, в интегральном.
    Необходимые условия минимума для задач с дифференциальными включениями как с выпуклыми, так и с невыпуклыми многозначными отображениями, исследовались в таких статьях, как [4–7]. Более конструктивные условия минимума
были получены в работах [8–10]. (Некоторые из перечисленных работ также рассматривают случай присутствия фазовых ограничений.) Множества достижимости
дифференциальных включений также изучались в различных работах (см., например, [11–15]).

      2. Постановка задачи. Рассмотрим дифференциальное включение
     В формуле (1) F (x, t) — заданное непрерывное многозначное отображение при
t ? [0, T ], x(t) — n-мерная непрерывная вектор-функция фазовых координат с кусочно-непрерывной (с конечным числом точек разрыва) и ограниченной на [0, T ]
производной, T > 0 — заданный конечный момент времени. Будем полагать, что
каждому моменту времени t ? [0, T ] и каждой фазовой точке x ? Rn отображение
F (x, t) ставит в соответствие некоторый выпуклый компакт из Rn . Предположим
также, что опорная функция многозначного отображения F (x, t) дифференцируема
по x и ее производная по x непрерывна. В формулах (2), (3) x0 , xT ? Rn — заданные
векторы.
     Требуется найти такую вектор-функцию x? ? Cn [0, T ], являющуюся решением
включения (1) и удовлетворяющую условиям (2), (3), которая доставляет минимум
функционалу, где f0 — заданная вещественная скалярная функция, непрерывная по всем трем ар-
гументам и непрерывно дифференцируемая по x и по x?. Предполагаем, что такое
решение существует.
      Здесь Cn [0, T ] — пространство n-мерных непрерывных на [0, T ] векторфункций с производной из пространства Pn [0, T ]; Pn [0, T ] — пространство кусочнонепрерывных и ограниченных на [0, T ] n-мерных вектор-функций, имеющих на [0, T ]
конечное число точек разрыва. Далее в статье также потребуется пространство
L2n [0, T ] суммируемых на [0, T ] с квадратом n-мерных вектор-функций.
      Если t0 ? [0, T ) — точка разрыва вектор-функции x?, то для определенности
полагаем, что x?(t0 ) — правосторонняя производная вектор-функции x? в точке t0 ;
x?(T ) — левосторонняя производная вектор-функции x? в точке T .
      Для произвольного множества F ? Rn определим опорную функцию вектора
? ? Rn соотношением c(F, ?) = sup  f, ? , где  a, b  — скалярное произведение
                                      f ?F
векторов a, b ? Rn .
    Замечание 1. Вместо траекторий из пространства Cn [0, T ] с производной из
пространства Pn [0, T ] в статье можно рассматривать абсолютно непрерывные на отрезке [0, T ] траектории с измеримой и почти всюду ограниченной на отрезке [0, T ]
производной соответственно. Такое рассмотрение при естественных предположениях гарантирует существование решения поставленной задачи. Выбор в статье пространства решений обусловлен возможностью их практического построения.

    3. Сведение к задаче безусловной оптимизации. Далее для краткости
будем иногда писать F вместо F (x, t). Поскольку ?t ? [0, T ] и ?x ? Rn многозначное
отображение F (x, t) представляет собой выпуклый компакт в Rn , то включение (1)
можно переписать иначе [16]. 

     4. Дифференциальные свойства функционала I. Как уже было отмече-
но, считаем, что опорная функция c(F (x, t), ?) многозначного отображения F (x, t)
дифференцируема по фазовой переменной x и что производная ?c(F (x,t),?)
                                                                    ?x    непре-
рывна по совокупности переменных. Тогда для любых x, y ? Cn [0, T ] и для любых
? ? S, t ? [0, T ] верно соотношение.
    Используя свойство аддитивности опорной функции по первому аргументу [3]
и равенства (9), (10), вычислим.
    В силу структуры функционала (5) легко заметить, что в случае  (?, z, t) > 0
максимум выражения
                         max{0,  (?, z, t)} =  (?, z, t)
достигается на единственном элементе ? ? (z, t) ? S. Действительно, в данном слу-
чае точка z не принадлежит множеству F . Из свойств опорной функции извест-
но [16], что при каждом фиксированном t ? [0, T ] величина h(z(t), t) представ-
ляет собой евклидово расстояние от точки z(t) до множества F (x(t), t), то есть
h(z(t), t) = ||z(t) ? f (x(t), t)|| (евклидова норма), где f (x(t), t) — проекция точки
z(t) на множество F (x(t), t), которая единственна, поскольку F (x(t), t) — выпук-
лый компакт. Отсюда видно, что максимум выражения h(z(t), t) =  (?, z(t), t) =
 z(t),
       ?  ? c(F (x(t),
                       t), ?) = ||z(t) ? f (x(t), t)|| достигается на векторе ? ? (z(t), t) =
 z(t)?f (x(t), t) /||z(t) ? f (x(t), t)||, который единственен в силу единственности век-
тора f (x(t), t). Поэтому в этом случае множество R(z, t) состоит из единственного
элемента ? ? (z, t).
     Замечание 2. Величина h(z(t), t) при каждом фиксированном t ? [0, T ] пред-
ставляет собой евклидово расстояние от точки z(t) до множества F (x(t), t), а функ-
ционал (7) есть половина квадрата отклонения в L2n [0, T ]-норме траектории z(t) от
множества F (x, t).
     Теперь нетрудно получить разложение.
    Очевидно, что при z ? ? функционал ? дифференцируем по Гато, и его гради-
ент Гато равен нулю.
    Рассмотрим случай z ?/ ?. Обозначим.
Как уже было отмечено, в этом случае данный максимум достигается на единствен-
ном элементе ? ? (z, t). Тогда функция ? ? (z, t) непрерывна по z при фиксированном
t [18], поэтому с учетом непрерывности функции ?c(F (x,t),?)
                                                        ?x    получаем, что функция
?w(z,t)
   ?z    непрерывна по z при фиксированном t. Далее по теореме Лагранжа о среднем
значении существует такое число ? = ?(t) ? [0, 1], что

Множитель max ||v(t)|| ограничен, поскольку v ? Pn [0, T ]. Норма под интегралом
               t?[0,T ]
стремится к нулю при ? v 0 при каждом фиксированном t ? [0, T ] в силу непрерывно-
сти функции ?w(z,t)
                ?z    по z при фиксированном t. Кроме того, эта норма ограничена в
силу непрерывности функции ?c(F (x,t),?)
                                       ?x      . Тогда по теореме Лебега о мажорируемой
сходимости выражение (11) стремится к нулю при ? v 0, что доказывает дифферен-
цируемость по Гато функционала ? в случае z ?             / ?.
    Вычисляя также классическую вариацию для функционалов ? и J, приходим
к следующему результату.
    Теорема 1. Если опорная функция c(F, ?) многозначного отображения F (x, t)
дифференцируема по x и ее производная по x непрерывна, то функционал I диффе-
ренцируем по Гато и его градиент в точке z находится по формуле
     5. Необходимые условия минимума функционала I. Из известного необ-
ходимого условия минимума [19] дифференцируемого по Гато функционала и соот-
ношения (12) заключаем, что справедлива следующая теорема.
     Теорема 2. Пусть опорная функция c(F, ?) многозначного отображения
F (x, t) дифференцируема по x и ее производная по x непрерывна. Для того что-
бы точка z ? доставляла минимум функционалу I необходимо.
    6. Метод наискорейшего спуска. Опишем метод наискорейшего спуска [20]
для поиска стационарных точек функционала I. Фиксируем произвольную точку
z1 ? Pn [0, T ]. Пусть уже построена точка zk ? Pn [0, T ]. Если выполнено условие
минимума (13), то точка zk является стационарной точкой функционала I, и процесс
прекращается. В противном случае положим. 
В силу (14) имеем I(zk+1 )   I(zk ). Если последовательность {zk } конечна, то
последняя ее точка является стационарной точкой функционала I по построению.
    Предположим, что функционал ?I является равномерно непрерывным и ограниченным в шаре пространства L2n [0, T ] с центром в начале координат и радиуса
r  > sup z L2n[0,T ] (множество Лебега Z1 = {z ? Pn [0, T ] | I(z)   I(z1 )} считаем ограниченным по норме L2n [0, T ]). Если последовательность {zk } бесконечна, то метод сходится [21] в следующем смысле.
     Замечание 3. Известно, что метод наискорейшего спуска часто медленно сходится. Особенно его неэффективность проявляется при больших значениях ?. Для преодоления этой трудности используют более эффективные методы, например, метод сопряженных градиентов, а также различные (в том числе эвристические) приемы, направленные на учет «овражной» структуры минимизируемого функционала [17].

    7. Численные примеры. Рассмотрим примеры реализации предложенного
алгоритма. В обоих примерах было взято значение. Вычислительный процесс прерывался на k -й итерации в случае ?I(zk )&&L2 [0,T ]   ?? = 5 ? 10?3 .

где B — единичный шар в Rn с центром в начале координат. Заданы краевые условия.
Требуется найти решение данного дифференциального включения, удовлетворяю-
щее заданным краевым условиям и доставляющее минимум следующему функцио-
налу.
    Было проведено 13 итераций согласно предложенному алгоритму, в результа-
те чего была построена точка x13 (см. рис. 1), при этом J(x13 ) = 2.219. На рис. 1
использовано обозначение u1 (t) = z1 (t) ? x2 (t), u2 (t) = z2 (t) ? x1 (t).
    Данный пример можно решить известными методами, если рассматривать его
с позиции теории управления. Эквивалентная этому примеру задача оптимального
управления имеет следующий вид.
    Нужно найти управление u ? P2 [0, T ], которое переводит систему из точки x(0) в точку x(1) и удовлетворяет ограничению.
При этом значение функционала должно быть наименьшим.
    Оптимальная траектория x? (t) была найдена с помощью принципа максиму-
ма Понтрягина с использованием метода стрельбы для поиска начальных значений
сопряженных переменных [22]. При этом оказалось J(x? ) = 2.195. Видно, что это
значение близко к найденному с помощью предложенного в статье метода (относи-
тельная погрешность не превышает 1%).
Задано начальное условие.
Требуется найти решение данного дифференциального включения, удовлетворяю-
щее заданному начальному условию и доставляющее минимум следующему функ-
ционалу, то есть найти исходящую из заданной начальной точки траекторию включения
с наименьшим значением координаты x2 в конечный момент времени.
    Было проведено 19 итераций согласно предложенному алгоритму, в результа-
те чего была построена точка x19 (см. рис. 2), при этом J(x19 ) = 0.835. На рис. 2
использовано обозначение u1 (t) = z1 (t) + x22 (t), u2 (t) = z2 (t) ? x1 (t).
Данный пример можно решить известными методами, если рассматривать его
с позиции теории управления. Эквивалентная этому примеру задача оптимального
управления имеет следующий вид.
    Нужно найти управление u ? P2 [0, T ], которое удовлетворяет ограничению и переводит систему из точки x(0) в точку с наименьшим значением координаты x2 в конечный момент
времени, то есть доставляет минимум функционалу.    
Оптимальная траектория x (t) была найдена с помощью принципа максиму-
ма Понтрягина с использованием метода стрельбы для поиска начальных значений
сопряженных переменных [22]. При этом оказалось J(x? ) = 0.803. Видно, что это
значение близко к найденному с помощью предложенного в статье метода (относи-
тельная погрешность не превышает 4%).
    Пример 3. Имеется дифференциальное включение, где Q — единичный квадрат в Rn Q = {x ? Rn | |xi |   1, ?i = 1, n} . Задано началь-
ное условие.
Требуется найти решение данного дифференциального включения, удовлетворяю-
щее заданному начальному условию и доставляющее минимум следующему функ-
ционалу, то есть найти исходящую из заданной начальной точки траекторию включения
с наименьшим значением координаты x2 в конечный момент времени.

     Была проведена 21 итерация согласно предложенному алгоритму, в резуль-
тате чего была построена точка x21 (см. рис. 3), при  этом J(x21 ) = ?1.712. На
рис. 3 сплошная линия        есть параметрическая кривая v1 (t) = z1 (t) + x2 (t), v2 (t) =
z2 (t) ? x1 (t), t ? [0, 1] . Пунктирная линия ограничивает допустимую область рас-
положения этой кривой.
    Данный пример можно решить известными методами, если рассматривать его
с позиции теории управления. Эквивалентная этому примеру задача оптимально-
го управления имеет следующий вид. Заметим, что эта задача управления имеет
неклассический вид: размерность управлений больше размерности фазовых коор-
динат.
    Нужно найти управление u ? P4 [0, T ], которое удовлетворяет ограничению и переводит систему из точки x(0) в точку с наименьшим значением координаты x2 в конечный момент
времени, то есть доставляет минимум функционалу.
    Оптимальная траектория x? (t) была найдена с помощью принципа максимума
Понтрягина. При этом оказалось J(x? ) = ?1.761. Видно, что это значение близко
к найденному с помощью предложенного в статье метода (относительная погрешность не превышает 3%).
    Замечание 4. Как известно, метод наискорейшего спуска не дает высокую
точность при достаточно большом значении штрафного параметра (и при не очень
большом количестве итераций). Выбор в расчетах точности ?? и штрафного параметра ?? основан на балансе между проведением небольшого количества итераций и
соблюдением сравнительно небольшой, но достаточной для приложений точности.
Вычисления проводились символьно в пакете Maple 12.0. Представляют интерес
дальнейшие исследования с целью повышения эффективности реализации предложенного в статье алгоритма, в том числе с использованием дискретизации и, возможно, других (более быстрых, чем метод наискорейшего спуска) методов минимизации в функциональном пространстве.

    8. Заключение. Таким образом, в данной статье рассмотрена задача поиска
оптимального в смысле интегрального функционала решения дифференциального включения с заданным начальным условием и с закрепленным правым концом.
С помощью аппарата опорных функций исходная задача сводится к минимизации
некоторого функционала. Для него найден градиент Гато, выписаны необходимые
условия минимума. На основании этих условий построен метод решения исходной
задачи, базирующийся на методе наискорейшего спуска. Реализация данного алгоритма иллюстрируется на численных примерах.
    Автор выражает искреннюю благодарность рецензентам за ценные замечания
и внимательное отношение к работе.

