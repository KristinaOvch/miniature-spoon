*24*
ПРИМЕНЕНИЕ МЕТОДА МЕТРОПОЛИСА В УЧЕБНОМ КОМПЬЮТЕРНОМ ЭКСПЕРИМЕНТЕ ПО МОЛЕКУЛЯРНОЙ ФИЗИКЕ
А. М.Толстик, к. ф.-м. н., доц
Тел.: (3822) 52-98-98, E-mail: tolstik@phys.tsu.ru Томский государственный университет http://www.tsu.ru

Введение.		
В физической науке за	последние 50 лет развились и получили широкое распространение методы машинного моделирования, главные из которых – динамический и Монте- Карло.	Сравнительно недавно эти методы начали применяться также в физическом образовании [1].
Под методом Монте-Карло понимается целая группа различных методов, основанных на работе со случайными (или в вычислительных машинах – псевдослучайными) числами. Использование метода Монте- Карло в физике началось в конце 50-х годов в физике твердого тела, плазмы, неидеального газа, жидкости, поверхностных явлений и т.д. [2]. Появление компьютерного эксперимента в сфере образования привело к применению метода Монте-Карло также в этой области. Он используется во всех видах учебных компьютерных экспериментов: для создания игр, демонстраций, лабораторных работ и т.д. [3]. Наиболее сложные применения метода Монте-Карло встречаются в молекулярной физике, где в виде метода Метрополиса [4] он применяется для создания «виртуальных» ансамблей Гиббса и вычисления средних значений физических величин для этих ансамблей. В этой работе рассмотрим несколько учебных компьютерных экспериментов по молекулярной физике, для создания которых использовался метод Метрополиса.
Метод Метрополиса. Макросостояние молекулярной системы описывается измеряемыми на опыте параметрами: объемом, давлением, температурой, напряженностями внешних полей, величинами, описывающими отклик системы на них, и т.д. Микросостояние системы описывается как в механике: заданием координат и скоростей всех молекул, а в квантовом случае – волновыми функциями квантовых («чистых») состояний всей системы. Каждому макросостоянию при конечной температуре соответствует огромное число микросостояний.
Для теоретического описания молекулярной системы рассматривается множество мысленных копий данной системы, находящихся в одинаковых, с макроскопической точки зрения, условиях (т.е. в одном и том же макросостоянии) – ансамбль Гиббса. Тогда для получения среднего значения любой физической величины в данном макросостоянии производится усреднение по ансамблю, т.е. A ? ?wi Ai  , где Ai – значение физической величины А в i-м микросостоянии; wi – вероятность встретить i-е микросостояние в ансамбле. В состоянии термодинамического равновесия можно применять любой гиббсовский ансамбль, т.к. в термодинамическом пределе – пределе бесконечно большого числа частиц – результаты применения одинаковы.
Например, если для описания системы применяется канонический ансамбль Гиббса, то вероятность нахождения системы
в i-м микросоcтоянии с энергией Еi равна
где k – постоянная Больцмана; Т – абсолютная температура; Z – статистическая сумма, служащая для нормировки вероятности (1).
Для создания виртуального ансамбля Гиббса генерируется случайный марковский процесс, который определяется заданием вероятности перехода молекулярной системы из произвольного микросостояния с номером i в другое произвольное микросостояние с номером j. Если вероятность этого перехода.
где ?Eij – приращение энергии системы в результате перехода из одного микросостояния в другое, то в этом случае при большом числе случайных испытаний каждое состояние системы реализуется с вероятностью (1), т.е. множество «пробегаемых» системой состояний образует канонический ансамбль Гиббса. Подобным же образом можно создать любой другой виртуальный гиббсовский ансамбль, например, больший канонический или р -Т - ансамбль.
В принципе начальное состояние системы может быть задано произвольным, однако, если оно является очень упорядоченным, а температура низкой, то переходы между состояниями «заморожены», они происходят с малой вероятностью, и виртуальное термодинамическое равновесие достигается в течение слишком большого времени. Число случайных испытаний в этом методе довольно велико – порядка 103 испытаний в расчете на одну частицу до достижения системой термодинамического равновесия и примерно столько же для вычисления средних значений необходимых физических величин.
Системы невзаимодействующих частиц во внешних полях. При реализации метода Метрополиса основные трудности связаны с расчетом приращения энергии при изменении микросостояния системы. Обычно состояние системы при каждом случайном испытании изменяется на один малый шаг: например, изменяется направление магнитного момента одного атома при рассмотрении магнетиков, производится смещение одной из молекул на малую величину при рассмотрении жидкостей или газов и т.п. При этом вследствие взаимодействия молекул расчет приращения энергии всей системы достаточно трудоемок и сложен в программном отношении.
Исключением являются задачи, в которых взаимодействие частиц друг с другом вообще не учитывается, а учитывается лишь воздействие на каждую из частиц внешних силовых полей. К числу таких одночастичных задач относятся задачи об идеальном газе во внешнем потенциальном поле (например, в однородном поле тяжести) и о парамагнетике в магнитном поле.
В первом компьютерном эксперименте демонстрируется распределение частиц идеального газа в однородном поле тяжести. Элементарное изменение состояния системы заключается в изменении высоты одной из частиц на небольшую случайную величину h, которая может быть с равной вероятностью как положительной, так и отрицательной. Если h < 0, то испытание безусловно принимается, при этом частица изображается на экране монитора на этой новой высоте. Если h > 0, то изменение энергии всей системы, равное в данном случае приращению потенциальной энергии одной данной частицы   ?E?mgh ,   также   положительно.   
В этом случае испытание принимается с вероятностью (2), для чего выбирается равномерно распределенное случайное число 0 < p < 1. Испытание принимается в том случае, если р ? e.
Виртуальный эксперимент можно провести для разных значений массы частиц m, ускорения свободного падения g и температуры T. Демонстрируется, что при больших значениях m и низких температурах частицы «поджимаются» книзу, а в противоположном случае распределение частиц по высоте становится более равномерным. Кадр из компьютерного эксперимента приведен на рис. 1 (см. цв. вставку). В одном из вариантов этого эксперимента строится также гистограмма распределения частиц по высоте. В этом случае эксперимент может быть поставлен в форме лабораторной работы, в которой по виду гистограмм определяются отношения масс частиц или температур для разных опытов.
Другой компьютерный эксперимент посвящен изучению намагниченности парамагнетика во   внешнем магнитном поле.
«Идеологически» эта задача близка предыдущей, так как в парамагнетике пренебрежимо мало взаимодействие между магнитными моментами атомов и учитывается только энергия взаимодействия магнитных моментов с внешним магнитным полем. В работе применяется модель Изинга, в которой считается, что магнитные моменты атомов могут принимать одно из двух возможных направлений, условно называемых «вверх» (т.е. по направлению внешнего магнитного поля) и «вниз». В этом эксперименте элементарным шагом является переворот магнитного момента одного произвольного атома. Изменение энергии системы при таком элементарном шаге – это изменение энергии данного атома в магнитном поле ?Е ? ?2 рВ , где В – индукция магнитного поля; р – магнитный момент атома, а знак зависит от взаимной ориентации магнитного момента данного атома и индукции поля (если после переворота магнитный момент станет направленным как вектор индукции, то этому соответствует знак «–»). Испытание принимается в том случае, если выработанное датчиком случайное число ??E р ? e kT , в противном случае испытание отвергается, и система остается в старом состоянии.
В результате множества подобных испытаний в виртуальном парамагнетике устанавливается состояние термодинамического равновесия, соответствующее заданным значениям температуры и напряженности внешнего магнитного поля. Продолжая выполнять подобные испытания, определяют среднюю намагниченность парамагнетика при заданных значениях этих параметров, а по полученным результатам находят парамагнитную восприимчивость при данной температуре и проверяют выполнимость закона Кюри, справедливого при высоких температурах и в слабых магнитных полях. Кадр из этого компьютерного эксперимента приведен на рис. 2 (см. цв. вставку).
Компьютерная лабораторная работа по изучению атомного упорядочения. Создана компьютерная лабораторная работа по изучению атомного упорядочения и атомного расслоения методом Монте-Карло (Метрополиса). В нашей лабораторной работе, предназначенной для студентов- металлофизиков или металловедов, рассматривается модельная центрированная квадратная решетка, на узлах которой размещаются атомы двух сортов, изображаемые на экране монитора кружками разных цветов и размеров (рис. 3 – см. цв. вставку). На рисунке представлен пример сильного расслоения с появлением областей чистого компонента. В случае применения модели к магнетикам эти области соответствуют доменам с противоположной ориентацией магнитных моментов.
Как и в большинстве подобных задач, для расчета энергии взаимодействия атомов друг с другом вводятся периодические граничные условия, а само межатомное взаимодействие учитывается в приближении ближайших соседей. Изменение знака пара- метра взаимодействия приводит к изменению типа атомного порядка – от упорядочения к расслоению или наоборот: при V < 0 атомы одного сорта стремятся окружить себя атомами другого сорта, а при V > 0 атомы каждого сорта стремятся окружить себя такими же атомами. Концентрация компонентов может быть задана произвольной.
Модель может быть применена также к изучению ферромагнетика, который в данной модели аналогичен распадающемуся сплаву, когда каждому атому энергетически выгодно окружать себя атомами такого же сорта (в случае ферромагнетика – атомами с такой же ориентацией магнитных моментов).
Для создания случайного марковского процесса, как и в предыдущих экспериментах, применяется метод Метрополиса для канонического распределения. Производится перестановка местами пары случайных атомов и рассчитывается изменение конфигурационной энергии кристалла ?Е при такой перестановке. Затем вычисляется больцмановский фактор е kT , после чего выбирается случайное число р с равномерным распределением на отрезке от нуля до единицы. Если р ? е kT , то новое состояние принимается в качестве одного из микросостояний системы, при обратном неравенстве оно отвергается, и в качестве нового состояния для усреднения по ансамблю еще раз берется старое.
Основную сложность представляет собой расчет приращения энергии кристалла при каждой элементарной перестановке, так как необходимо учитывать взаимодействие атомов друг с другом. Поэтому при каждой перестановке изменяется энергия взаимодействия со своим ближайшим окружением не только у самих переставляемых атомов, но и у их соседей. Это очень сильно усложняет программу компьютерного эксперимента по сравнению с задачами, в которых изучается поведение систем невзаимодействующих друг с другом частиц во внешних полях.
При выполнении компьютерного эксперимента после установления состояния термодинамического равновесия определяется параметр ближнего порядка, который характеризует среднюю по кристаллу степень окружения атомов одного сорта атомами другого сорта и вводится через вероятности соседства соответствующих атомов. Степень дальнего порядка в этой методике определить затруднительно, так как даже при сравнительно низких температурах модельная система разбивается на так называемые антифазные домены, в результате чего среднее значение параметра дальнего порядка всего кристалла может оказаться близким к нулю или даже равным нулю. Возможно определение параметра дальнего порядка в каждом из образовавшихся доменов, а затем его усреднение по всем доменам, однако эта процедура нерегулярная и должна проводиться под контролем преподавателя.
Заключение. Таким образом, метод Метрополиса может применяться не только в научном, но и в учебном компьютерном эксперименте, позволяя создать учебный компьютерный эксперимент, недоступный другим методам машинного моделирования. Создаваемый компьютерный эксперимент обладает высокой степенью наглядности и позволяет изучать строение различных веществ на молекулярном уровне в рамках адекватной модели, соответствующей современным физическим представлениям.

Литература
1.	Гулд Х.; Тобочник Я. Компьютерное моделирование в физике; В 2 ч. – М.: Мир, 1990.
2.	Биндер К. Общие вопросы теории и техники статистического моделирования методом Монте- Карло // Методы Монте-Карло в статистической физике. – М.: Мир. – 1982. – С. 9-57.
3.. Толстик А.М. Применение метода Монте-Карло в учебном компьютерном эксперименте по физике // Информационные технологии. – 2001. – № 9. – С. 53-55.
4. Metropolis N . , Rosenbluth A.W., Rosenbluth M.N., Teller A.H., Teller E. Equation of State Calcula- tions by fast Computing Machines // J. Chem. Phys. – 1953. – Vol. 21. – P. 1087-1103.

